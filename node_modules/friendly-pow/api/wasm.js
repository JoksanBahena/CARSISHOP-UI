import { instantiateWasmSolver } from "../loader";
export async function getWasmSolver(module) {
    const w = await instantiateWasmSolver(module);
    const arrPtr = w.exports.__retain(w.exports.__allocArray(w.exports.Uint8Array_ID, new Uint8Array(128)));
    let solution = w.exports.__getUint8Array(arrPtr);
    return (puzzleBuffer, threshold, n = 4294967295) => {
        solution.set(puzzleBuffer);
        const hashPtr = w.exports.solveBlake2b(arrPtr, threshold, n);
        solution = w.exports.__getUint8Array(arrPtr);
        const hash = w.exports.__getUint8Array(hashPtr);
        w.exports.__release(hashPtr);
        return [solution, hash];
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2FzbS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9hcGkvd2FzbS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFFbEQsTUFBTSxDQUFDLEtBQUssVUFBVSxhQUFhLENBQUMsTUFBVztJQUM3QyxNQUFNLENBQUMsR0FBRyxNQUFNLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBRTlDLE1BQU0sTUFBTSxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUMvQixDQUFDLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLGFBQWEsRUFBRSxJQUFJLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUNyRSxDQUFDO0lBQ0YsSUFBSSxRQUFRLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLENBQUM7SUFFakQsT0FBTyxDQUFDLFlBQXdCLEVBQUUsU0FBaUIsRUFBRSxDQUFDLEdBQUcsVUFBVSxFQUFFLEVBQUU7UUFDcEUsUUFBdUIsQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDM0MsTUFBTSxPQUFPLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsTUFBTSxFQUFFLFNBQVMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUM3RCxRQUFRLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDN0MsTUFBTSxJQUFJLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxlQUFlLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDaEQsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDN0IsT0FBTyxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUMxQixDQUFDLENBQUM7QUFDSixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaW5zdGFudGlhdGVXYXNtU29sdmVyIH0gZnJvbSBcIi4uL2xvYWRlclwiO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0V2FzbVNvbHZlcihtb2R1bGU6IGFueSkge1xuICBjb25zdCB3ID0gYXdhaXQgaW5zdGFudGlhdGVXYXNtU29sdmVyKG1vZHVsZSk7XG5cbiAgY29uc3QgYXJyUHRyID0gdy5leHBvcnRzLl9fcmV0YWluKFxuICAgIHcuZXhwb3J0cy5fX2FsbG9jQXJyYXkody5leHBvcnRzLlVpbnQ4QXJyYXlfSUQsIG5ldyBVaW50OEFycmF5KDEyOCkpXG4gICk7XG4gIGxldCBzb2x1dGlvbiA9IHcuZXhwb3J0cy5fX2dldFVpbnQ4QXJyYXkoYXJyUHRyKTtcblxuICByZXR1cm4gKHB1enpsZUJ1ZmZlcjogVWludDhBcnJheSwgdGhyZXNob2xkOiBudW1iZXIsIG4gPSA0Mjk0OTY3Mjk1KSA9PiB7XG4gICAgKHNvbHV0aW9uIGFzIFVpbnQ4QXJyYXkpLnNldChwdXp6bGVCdWZmZXIpO1xuICAgIGNvbnN0IGhhc2hQdHIgPSB3LmV4cG9ydHMuc29sdmVCbGFrZTJiKGFyclB0ciwgdGhyZXNob2xkLCBuKTtcbiAgICBzb2x1dGlvbiA9IHcuZXhwb3J0cy5fX2dldFVpbnQ4QXJyYXkoYXJyUHRyKTtcbiAgICBjb25zdCBoYXNoID0gdy5leHBvcnRzLl9fZ2V0VWludDhBcnJheShoYXNoUHRyKTtcbiAgICB3LmV4cG9ydHMuX19yZWxlYXNlKGhhc2hQdHIpO1xuICAgIHJldHVybiBbc29sdXRpb24sIGhhc2hdO1xuICB9O1xufVxuIl19